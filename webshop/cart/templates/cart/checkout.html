{% extends "shop/base.html" %}
{% load static %}

{% block title %}
    Twój koszyk
{% endblock %}

{% block content %}
	{% if cart.get_total_price > 0%}
		<h1>Twój koszyk</h1>
		<table class="cart" style="width:100%">
			<thead>
				<tr class="border-bottom">
					<th>Obraz</th>
					<th>Produkt</th>
					<th>Ilość</th>
					<th>Usuń</th>
					<th>Cena jednostkowa</th>
					<th class="num text-right">Cena</th>
				</tr>
			</thead>
			<tbody>
				{% for item in cart %}
					{% with product=item.product %}
						<tr>
							<td>
								<a href="{{ product.get_absolute_url }}">
									<img src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'img/no-image.png' %}{% endif %}" height="50" width="50">
								</a>
							</td>
							<td>{{ product.name }}</td>
							<td>{{ item.quantity }}</td>
							<td><a href="{% url 'cart:cart_remove' product.id %}">Usuń</a></td>
							<td class="num">{{ item.price }} PLN</td>
							<td class="num text-right">{{ item.total_price }} PLN</td>
						</tr>
					{% endwith %}
				{% endfor %}
				<tr>
					<td colspan="5"></td>               	
					<td class="num border-top text-right">Wartość zakupów: {{ cart.get_total_price }} PLN</td>
				</tr>
			</tbody>
		</table>
		<form action="" method="post">
			{% if user.is_authenticated %}
				{% if cart.get_total_price > 0 %}
					<h3><i class="fas fa-truck"></i> Sposób dostawy</h3>
					{% csrf_token %}
					{% for radio in delivery_form.delivery_type %}
						<label for="{{ radio.name }}">
							{{ radio }}
							<span class="radio">{{ radio.name }}</span>
						</label>
						<br>
					{% endfor %}
				{% endif %}
			{% endif %}
		</form>
		
			<p class="text-right">
				<a href="{% url 'shop:product_list' %}" class="button
				light btn btn-primary">Kontynuuj zakupy</a>
				{% if cart.get_total_price > 0 and user.is_authenticated %}
					<button type="submit" class="button btn btn-primary">Kupuję i płacę</button>
				{% else %}
					<button type="button" class="button btn btn-primary" disabled>Kupuję i płacę</button>
				{% endif %}
			</p>
	{% else %}
		<h5> Twój koszyk jest obecnie pusty. </h5>
		<!-- Insert recommended products here -->
	{% endif %}

{% endblock %}

